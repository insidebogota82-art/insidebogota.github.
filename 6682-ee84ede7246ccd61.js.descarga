"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6682],{16682:function(e,t,n){var s=n(47568),i=n(82670),o=n(10253),a=n(97582),u=n(33299),r=n(61437),l=n(74865),c=n.n(l),d=n(30120),p=n(67294),h=n(87066),f=n(3732),v=n(11163).useRouter;c().configure({showSpinner:!1}),t.Z=function(){var e,t=function(){var e=(null===b||void 0===b?void 0:b.query).redirect;return(0,u.signOut)({callbackUrl:"/login?redirect=".concat(e||b.asPath),redirect:!1}).then((function(e){b.push(e.url),sessionStorage.clear();try{localStorage.clear()}catch(t){}}))},n=function(e,t){switch(e){case"subscription-required":b.pathname.includes("/upgrade")||b.pathname.includes("/success")||document.querySelector(".paywall-modal")||w(t||e);break;case"paywall":b.pathname.includes("/upgrade")||b.pathname.includes("/success")||b.pathname.includes("/invoices/list")||b.pathname.includes("/dashboard")||document.querySelector(".paywall-modal")||w(t||e)}},l=function(){w(!1)},c=function(e,s){if(g(!1),e.response){var i,o,a;if(401===e.response.status&&t(),403===e.response.status&&!b.pathname.includes("/upgrade")&&!b.pathname.includes("/welcome"))return n(e.response.data.message,e.response.data.content),void s({status:!1});s({status:!1,message:e.response.data.message,content:null===(i=e.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.content,code:null===(a=e.response)||void 0===a?void 0:a.status})}else e.request?s({status:!1,message:e.request}):s({status:!1,message:e.message})},m=(0,o.Z)((0,r.Z)("header-loader",!1),2),g=(m[0],m[1]),y=(0,o.Z)((0,r.Z)("api-paywall",!1),2),w=(y[0],y[1]),b=v(),_="https://api.durable.co",C=(0,u.useSession)().data,S="Bearer ".concat(null===C||void 0===C||null===(e=C.user)||void 0===e?void 0:e.token);function Z(e,t,n,s){return B.apply(this,arguments)}function B(){return B=(0,s.Z)((function(e,t,n,s){var i,o,u,r,l,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return o=null===t||void 0===t?void 0:t.idBusiness,(null===t||void 0===t?void 0:t.idBusiness)&&s&&delete t.idBusiness,u=d.ou.now().toMillis(),l={"Content-Type":"application/json",Accept:"*/*",Authorization:S,"X-Timestamp":u},c="X-Signature",[4,(0,f.Hl)(e,t,u,null===C||void 0===C||null===(i=C.user)||void 0===i?void 0:i.token)];case 1:return l[c]=a.sent(),l["id-business"]=null!==o&&void 0!==o?o:(0,f.h_)(),r=l,n&&(r["Content-Type"]="multipart/form-data",r["X-Content-Type-Options"]="nosniff",r["Content-Disposition"]="attachment"),[2,r]}}))})),B.apply(this,arguments)}function T(){return T=(0,s.Z)((function(e,i){var o,u,r,l,c,p,v,m,y,w=arguments;return(0,a.__generator)(this,(function(Z){switch(Z.label){case 0:return o=!(w.length>2&&void 0!==w[2])||w[2],u=!(w.length>3&&void 0!==w[3])||w[3],o&&g(!0),l=d.ou.now().toMillis(),c=null===i||void 0===i?void 0:i.idBusiness,(null===i||void 0===i?void 0:i.idBusiness)&&u&&delete i.idBusiness,p=null!==c&&void 0!==c?c:(0,f.h_)(),m={"Content-Type":"application/json",Accept:"application/json",Authorization:S,"X-Timestamp":l},y="X-Signature",[4,(0,f.Hl)(e,{},l,null===C||void 0===C||null===(r=C.user)||void 0===r?void 0:r.token)];case 1:return m[y]=Z.sent(),m["id-business"]=p,v=m,[2,new Promise((function(u,r){var l="".concat(e,"-").concat(JSON.stringify(i),"-").concat(p),c="cache:".concat(btoa(unescape(encodeURIComponent(l)))),f=sessionStorage.getItem(c);try{f=f?JSON.parse(f):null}catch(m){f=null}f&&(null===f||void 0===f?void 0:f.content)&&(null===f||void 0===f?void 0:f.timestamp)&&d.ou.now().diff(d.ou.fromMillis(f.timestamp),"seconds").seconds<2?(o&&g(!1),console.log("Using cache for request",e),u(f.content)):h.Z.get(e,{baseURL:_,withCredentials:!0,params:i||{},headers:v}).then(function(){var e=(0,s.Z)((function(e){return(0,a.__generator)(this,(function(t){return o&&g(!1),sessionStorage.setItem(c,JSON.stringify({content:e.data,timestamp:d.ou.now().toMillis()})),setTimeout((function(){sessionStorage.removeItem(c)}),2e3),u(e.data),[2]}))}));return function(t){return e.apply(this,arguments)}}()).catch((function(e){if(o&&g(!1),e.response){if(401===e.response.status&&t(),403===e.response.status&&!b.pathname.includes("/upgrade")&&!b.pathname.includes("/welcome"))return n(e.response.data.message,e.response.data.content),void u({status:!1});u({status:!1,message:e.response.data.message})}else e.request?u({status:!1,message:e.request}):u({status:!1,message:e.message})}))}))]}}))})),T.apply(this,arguments)}function q(){return q=(0,s.Z)((function(e,s){var o,u,r,l,c,p,v,m,y=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return o=y.length>2&&void 0!==y[2]&&y[2],u=!(y.length>3&&void 0!==y[3])||y[3],g(!0),l=d.ou.now().toMillis(),"form-data"===((0,i.Z)(s,FormData)?"form-data":"object")?(c=s.get("idBusiness"))&&u&&s.delete("idBusiness"):(c=null===s||void 0===s?void 0:s.idBusiness,(null===s||void 0===s?void 0:s.idBusiness)&&u&&delete s.idBusiness),v={"Content-Type":"application/json",Accept:"application/json",Authorization:S,"X-Timestamp":l},m="X-Signature",[4,(0,f.Hl)(e,s,l,null===C||void 0===C||null===(r=C.user)||void 0===r?void 0:r.token)];case 1:return v[m]=a.sent(),v["id-business"]=null!==c&&void 0!==c?c:(0,f.h_)(),p=v,o&&(p["Content-Type"]="multipart/form-data",p["X-Content-Type-Options"]="nosniff",p["Content-Disposition"]="attachment"),[2,new Promise((function(i,o){h.Z.post(e,s||{},{headers:p,baseURL:_,withCredentials:!0}).then((function(e){g(!1),i(e.data)})).catch((function(e){if(g(!1),e.response){var s,o,a;if(401===e.response.status&&t(),403===e.response.status&&!b.pathname.includes("/upgrade")&&!b.pathname.includes("/welcome"))return n(e.response.data.message,e.response.data.content),void i({status:!1});i({status:!1,message:e.response.data.message,content:null===(s=e.response)||void 0===s||null===(o=s.data)||void 0===o?void 0:o.content,code:null===(a=e.response)||void 0===a?void 0:a.status})}else e.request?i({status:!1,message:e.request}):i({status:!1,message:e.message})}))}))]}}))})),q.apply(this,arguments)}function k(){return k=(0,s.Z)((function(e,s){var i,o,u,r,l,c;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return g(!0),o=d.ou.now().toMillis(),u=null===s||void 0===s?void 0:s.idBusiness,(null===s||void 0===s?void 0:s.idBusiness)&&delete s.idBusiness,l={"Content-Type":"application/json",Accept:"application/json",Authorization:S,"X-Timestamp":o},c="X-Signature",[4,(0,f.Hl)(e,s,o,null===C||void 0===C||null===(i=C.user)||void 0===i?void 0:i.token)];case 1:return l[c]=a.sent(),l["id-business"]=null!==u&&void 0!==u?u:(0,f.h_)(),r=l,[2,new Promise((function(i,o){h.Z.delete(e,{data:s||{},headers:r,baseURL:_,withCredentials:!0}).then((function(e){g(!1),i(e.data)})).catch((function(e){if(g(!1),e.response){if(401===e.response.status&&t(),403===e.response.status&&!b.pathname.includes("/upgrade")&&!b.pathname.includes("/welcome"))return n(e.response.data.message,e.response.data.content),void i({status:!1});i({status:!1,message:e.response.data.message})}else e.request?i({status:!1,message:e.request}):i({status:!1,message:e.message})}))}))]}}))})),k.apply(this,arguments)}function X(){return X=(0,s.Z)((function(e,t){var n,s,i,o=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=o.length>2&&void 0!==o[2]&&o[2],s=!(o.length>3&&void 0!==o[3])||o[3],g(!0),[4,Z(e,t,n,s)];case 1:return i=a.sent(),[2,new Promise((function(n,s){h.Z.patch(e,t||{},{headers:i,baseURL:_,withCredentials:!0}).then((function(e){g(!1),n(e.data)})).catch((function(e){return c(e,n)}))}))]}}))})),X.apply(this,arguments)}function j(){return j=(0,s.Z)((function(e,t){var n,s,i,o=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return n=o.length>2&&void 0!==o[2]&&o[2],s=!(o.length>3&&void 0!==o[3])||o[3],g(!0),[4,Z(e,t,n,s)];case 1:return i=a.sent(),[2,new Promise((function(n,s){h.Z.put(e,t||{},{headers:i,baseURL:_,withCredentials:!0}).then((function(e){g(!1),n(e.data)})).catch((function(e){return c(e,n)}))}))]}}))})),j.apply(this,arguments)}function A(){return A=(0,s.Z)((function(e,t,n){var s,i,o,u,r,l,c,p=arguments;return(0,a.__generator)(this,(function(a){switch(a.label){case 0:return s=!(p.length>3&&void 0!==p[3])||p[3],o=d.ou.now().toMillis(),t||(t={}),u=null===t||void 0===t?void 0:t.idBusiness,(null===t||void 0===t?void 0:t.idBusiness)&&s&&delete t.idBusiness,t.stream=!0,l={"Content-Type":"application/json",Authorization:S,"X-Timestamp":o},c="X-Signature",[4,(0,f.Hl)(e,t,o,null===C||void 0===C||null===(i=C.user)||void 0===i?void 0:i.token)];case 1:return l[c]=a.sent(),l["id-business"]=null!==u&&void 0!==u?u:(0,f.h_)(),r=l,fetch("".concat(_).concat(e),{method:"POST",headers:r,body:JSON.stringify(t)}).then((function(e){var t=e.body.getReader(),s=function(){t.read().then((function(e){var t=e.done,i=e.value,o=new TextDecoder;if(t)"function"===typeof n&&n("[DONE]");else{if("function"===typeof n){var a=o.decode(i).replace(/data: (.*)\n\n/g,"$1");n(a)}s()}}))};s()})).catch((function(e){console.log(e)})),[2]}}))})),A.apply(this,arguments)}return(0,p.useEffect)((function(){return b.events.on("routeChangeComplete",l),function(){b.events.off("routeChangeComplete",l)}}),[b.events]),{get:function(e,t){return T.apply(this,arguments)},post:function(e,t){return q.apply(this,arguments)},put:function(e,t){return j.apply(this,arguments)},remove:function(e,t){return k.apply(this,arguments)},stream:function(e,t,n){return A.apply(this,arguments)},patch:function(e,t){return X.apply(this,arguments)}}}}}]);